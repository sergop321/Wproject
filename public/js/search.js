// Generated by CoffeeScript 1.6.3
$(function() {
  var available, category, origin, price_max, price_min, sub_category;
  $("#main_categories a").click(function(event) {
    event.preventDefault();
    if ($(this).parent().hasClass("selected")) {
      return $(this).parent().removeClass("selected");
    } else {
      return $(this).parent().addClass("selected");
    }
  });
  $(".categories #main_categories i").click(function(event) {
    var sub_category;
    event.preventDefault();
    sub_category = $(this).parent().find("ul.sub_categories");
    if ($(sub_category).hasClass("hidden")) {
      $(this).transition({
        rotate: '-90deg'
      });
      $(sub_category).slideDown("slow");
      return $(sub_category).removeClass("hidden");
    } else {
      $(this).transition({
        rotate: '0deg'
      });
      return $(sub_category).slideUp(400, function() {
        return $(sub_category).addClass("hidden");
      });
    }
  });
  window.router();
  window.onhashchange = window.router;
  category = get_parm_from_query("category");
  sub_category = get_parm_from_query("sub_category");
  origin = get_parm_from_query("origin");
  available = get_parm_from_query("available");
  price_max = get_parm_from_query("price_max");
  price_min = get_parm_from_query("price_min");
  price_max = price_max != null ? parseInt(price_max, 10) : 1000;
  price_min = price_min != null ? parseInt(price_min, 10) : 0;
  if (category != null) {
    if ($("#" + category).length > 0) {
      $("#" + category).find("ul.sub_categories").removeClass("hidden");
      $("#" + category).find("i.icon-chevron-left").transition({
        rotate: '-90deg'
      });
      if ($("#" + sub_category).length > 0) {
        $("#" + sub_category).addClass("selected");
      } else {
        $("#" + category).addClass("selected");
      }
    }
  }
  if (origin != null) {
    if ($("#region option[value=" + origin + "]").length > 0) {
      $("#region option[value=" + origin + "]").attr("selected", "selected");
    }
  }
  if (available != null) {
    if (available === 1 || available === "1") {
      $("#available").prop("checked", true);
    }
  }
  $("#slider-range").slider({
    range: true,
    min: 0,
    max: 1000,
    values: [price_min, price_max],
    slide: function(event, ui) {
      return $("#product_price_range").val(ui.values[0] + " - " + ui.values[1] + " שח ");
    }
  });
  return $("#product_price_range").val($("#slider-range").slider("values", 0) + " - " + $("#slider-range").slider("values", 1) + " שח ");
});
